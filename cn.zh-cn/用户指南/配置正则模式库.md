# 配置正则模式库<a name="ZH-CN_TOPIC_0111166555"></a>

用户可根据需要创建正则表达式，基于创建的正则表达式可创建查询模式组，并应用于数据库安全规则。

-   支持手动创建正则表达式模式。
-   支持通过单击“学习模式“或“注入模式“窗口中的“转换为正则表达式“来创建正则表达式。这种情况下，新的查询模式被创建，原学习模式不受影响。

## 操作步骤<a name="zh-cn_topic_0110574910_section942916714238"></a>

1.  在HexaTier主菜单上，单击“资源“。
2.  在导航树上，选择“查询模式 \> 正则模式库“。
3.  根据需要执行以下操作：
    -   创建新的正则表达式模式

        在命令栏上，单击“新建“。

    -   编辑已有的正则表达式模式

        找到要编辑的正则表达式模式，然后单击该行末尾的![](figures/编辑.png)（编辑）。


4.  在“模式名称“文本框中，输入模式名称。
5.  （可选）在“颜色“栏，选择一个颜色来设置查看正则表达式模式列表时，改正则表达式模式名称的显示颜色。
6.  在“数据库类型“下拉框中选择数据库类型：

    -   MySQL
    -   MS-SQL
    -   PostgresQL
    -   LibrA/DWS

    >![](public_sys-resources/icon-note.gif) **说明：**   
    >查询模式可属于相同数据库类型组。该组也可以是数据库安全规则的一部分。如果一个组包含在数据库安全规则中，它只能属于数据库安全规则中定义的相同数据库类型。  

7.  在“正则表达式定义“框中，键入正则表达式。
8.  “宏“和“图例“提供了提示，用户可以使用这些提示创建和编辑正则表达式：

    -   使用“宏“链接（任何、常量、数字、引用的字符串）向“正则表达式定义“文本框中添加规则字符串。
    -   单击“图例“查看相关字符串及其说明。

    在状态栏中（文本框右下方），系统会自动显示用户输入的正则表达式是有效还是无效。如果表达式无效，则无法保存或测试正则表达式。

9.  在“测试样例“字段中，键入SQL查询或语句，然后单击“测试匹配“来确定测试内容是否匹配定义的正则表达式。
10. 单击“创建“或“更新“。

## 自动创建正则表达式模式<a name="zh-cn_topic_0110574910_section1611863916142"></a>

用户可以将学习模式学习到的查询模式和检测到的注入模式转换为正则表达式。

-   将学习模式转换为正则表达式模式：
    1.  在HexaTier主菜单上，单击“资源“。
    2.  在导航树上，选择“查询模式 \> 学习模式库“。
    3.  找到要转换的学习模式，然后单击该行末尾的![](figures/编辑.png)（编辑）。
    4.  单击“转换为正则表达式模式“。

        跳转到正则表达式创建页面。

    5.  设置“模式名称“、“颜色“和“数据库类型“。
    6.  （可选）输入测试样例，并单击“测试匹配“验证正则表达式。
    7.  单击“创建“。

-   将注入模式转换为正则表达式模式：
    1.  在HexaTier主菜单上，单击“资源“。
    2.  在导航树上，选择“查询模式 \> 注入模式库“。
    3.  单击要转换的注入模式。
    4.  单击“转换为正则表达式模式“。

        跳转到正则表达式创建页面。

    5.  设置“模式名称“、“颜色“和“数据库类型“。
    6.  （可选）输入测试样例，并单击“测试匹配“验证正则表达式。
    7.  单击“创建“。


