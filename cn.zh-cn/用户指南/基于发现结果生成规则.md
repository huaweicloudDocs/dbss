# 基于发现结果生成规则<a name="ZH-CN_TOPIC_0111166402"></a>

基于发现结果，可生成监控规则、脱敏规则和防火墙规则。用户可在监控策略列表、脱敏策略列表或者防火墙策略列表中管理生成的策略。

>![](public_sys-resources/icon-note.gif) **说明：**   
>-   基于发现结果生成防火墙规则时，HexaTier只支持以表（即选择发现结果的所属表）为粒度生成规则。  
>-   基于发现结果生成的防火墙规则，HexaTier默认其优先级最低，如需要更改规则的优先级，请参见[重新排序数据库安全规则](重新排序数据库安全规则.md#ZH-CN_TOPIC_0111166552)。  

## 操作步骤<a name="zh-cn_topic_0180960156_sfc30c486e8f84928ae55e3ab71c2e86f"></a>

1.  在HexaTier主菜单上，单击“发现“。
2.  在导航树上，选择“发现结果“。
3.  如果工作区中的“敏感字段“列显示“发现“，则单击“查看“列中“详情“。

    “详细结果“窗口显示不合规的所有表列。

4.  为发现的敏感列创建监控规则：
    1.  勾选该行监控规则列的复选框。
    2.  单击“生成“。

        将为选定的列自动生成监控规则。用户可以在监控策略列表中编辑自动生成的监控策略，请参见[创建或编辑活动监控规则](创建或编辑活动监控规则.md#ZH-CN_TOPIC_0111166467)。

        **图 1**  生成监控策略<a name="zh-cn_topic_0180960156_fig5517174920817"></a>  
        ![](figures/生成监控策略.png "生成监控策略")

5.  为发现的敏感列创建脱敏规则：
    1.  勾选该行脱敏规则列的复选框。
    2.  单击“生成“。
    3.  在弹出窗口中单击“确定“。

        将为选定的列自动生成脱敏规则。用户可以在脱敏策略列表中编辑自动生成的脱敏策略，请参见[创建或编辑数据脱敏规则](创建或编辑数据脱敏规则.md#ZH-CN_TOPIC_0111166389)。

        **图 2**  生成脱敏策略<a name="zh-cn_topic_0180960156_fig282916414911"></a>  
        ![](figures/生成脱敏策略.png "生成脱敏策略")

6.  为发现的敏感列创建防火墙规则：
    1.  勾选该行防火墙规则列的复选框。
    2.  单击“生成“。
    3.  在弹出窗口中单击“确定“。

        将为选定的列自动生成防火墙规则。用户可以在防火墙策略列表中编辑自动生成的防火墙策略，请参见[配置数据库防火墙策略](配置数据库防火墙策略.md#ZH-CN_TOPIC_0111166518)。

        **图 3**  生成防火墙策略<a name="zh-cn_topic_0180960156_fig13502176115917"></a>  
        ![](figures/生成防火墙策略.png "生成防火墙策略")



## 删除自动生成的规则<a name="zh-cn_topic_0180960156_section1274554102920"></a>

-   删除自动生成的监控规则：
    1.  在HexaTier主菜单上，单击“监控“。
    2.  在命令栏上，选择“删除所有自动生成的规则“。
    3.  在弹出窗口，单击“确定“。

-   删除自动生成的脱敏规则：
    1.  在HexaTier主菜单上，单击“脱敏“。
    2.  在命令栏上，选择“删除所有自动生成的规则“。
    3.  在弹出窗口，单击“确定“。

-   删除自动生成的防火墙规则：
    1.  在HexaTier主菜单上，单击“防火墙“。
    2.  在命令栏上，选择“删除所有自动生成的规则“。
    3.  在弹出窗口，单击“确定“。


>![](public_sys-resources/icon-note.gif) **说明：**   
>-   只有当用户通过发现任务自动生成了相应的监控规则、脱敏规则或防火墙规则，命令栏中才会显示“删除所有自动生成的规则“按钮。  
>-   通过发现任务自动生成的规则，在对应的规则列表中编辑并保存成功后，不支持通过“删除所有自动生成的规则“按钮进行删除操作。  

